/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package com.palashmax.mangareader

import com.github.kittinunf.fuel.httpGet
import com.github.kittinunf.result.Result;
import org.jsoup.Jsoup
import java.util.stream.Collectors

class MangaReader {
    fun fetchTitles(): List<String> {
        val (request, response, result) = "https://www.mangareader.net/alphabetical"
            .httpGet()
            .responseString()

        when (result) {
            is Result.Failure -> {
                val ex = result.getException()
                println(ex)
            }
            is Result.Success -> {
                val data = result.get()
                var doc = Jsoup.parse(data)
                // doc.getElementsByClass("series_alpha")
                var series_alpha_uls = doc.select("ul.series_alpha")
                var mangaList = ArrayList<String>()
                series_alpha_uls.stream().forEach { series_alpha_ul ->
                    series_alpha_ul.select("li")
                        .stream()
                        .forEach{ series_alpha_ul_li ->
                            mangaList.add(series_alpha_ul_li.select("a").text())
                        }
                }
                return mangaList
            }
        }
        return ArrayList<String>()
    }
}

fun main() {
    val mr = MangaReader()
    val titles = mr.fetchTitles()

}
